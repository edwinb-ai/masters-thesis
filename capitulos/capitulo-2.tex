\chapter{Liquid State Theory}
\label{Cap2}

In this chapter, a brief description of Liquid State Theory is carried out. In particular, 
the focus of the chapter is to state what a liquid is, its thermodynamical properties and
how equilibrium statistical mechanics is used to understand them. Then, a description of 
The hard-sphere fluid is mentioned, which is the fundamental system studied in this work.
Then, the theory of integral equations is presented, and from this the Ornstein-Zernike 
formalism is derived. The chapter is closed with a brief description of computer simulation
methods, and in particular, of the Monte Carlo computer simulation method. Monte Carlo 
simulations are numerical schemes that make it possible to study liquids based on 
first-principles, attempting to approximate the underlying probability distribution of
the system, and with this, to obtain all the physical properties of the fluid.

\section{Equilibrium Statistical Mechanics}
\label{sec:eq-statmech}

Consider a system of $N$ spherical particles in three dimensions
where each particle is characterized by its position $\vecr$ and momentum $\vecp$.
The \emph{Hamiltonian} of the system is given by
\begin{equation}
    \mathcal{H} \left( \vecr, \vecp \right) = 
    K \left( \vecp \right) + U \left( \vecr \right)
    \label{eq:hamiltonian}
\end{equation}
with $K$ the kinetic energy and $U$ the potential energy of the system.
All together, the 6$N$ variables define a \emph{phase point} in a 6$N$-dimensional
\emph{phase space}. The state point of the system is then described by a
\emph{phase space vector} $\Gamma \left( \vecr, \vecp \right)$, however, considering that all
6$N$ particles move according to Newton's equations of motion, $\Gamma$ is
a function of time, or $\Gamma(t)$. Using this phase space vector, \emph{time averages}
can be obtained for a given observable $A$ by means of the following expression
\begin{equation}
    \left< A \right> = \lim_{t \to \infty} \frac{1}{t} 
    \int_{0}^{t} A \: \Gamma(t') \: dt'
    \label{eq:time-average}
\end{equation}
If instead the complete set of state points, also known as the \emph{ensemble} of state
poitns, is considered then the average $\left< A \right>$ can then be rewritten in
terms of this ensemble. First, we point out the following for the state point vectors.
This ensemble of state points is distributed in phase space according to a probability 
distribution that is specified by the \emph{thermodynamic ensemble.} Then, if the time 
evolution of $\Gamma(t)$ is such that all states are visited eventually, irrespective of 
its initial conditions, the system satisfies the weak ergodic
theorem~\cite{kittelElementaryStatisticalPhysics2004},
and we can now rewrite the time average in \autoref{eq:time-average} with
an \emph{ensamble average} that reads
\begin{equation}
    \left< A \right> = \sum_{\Gamma} A(\Gamma) \: \rho_{ens} (\Gamma)
    \label{eq:ensemble-average}
\end{equation}
where the sum is for all state point vectors $\Gamma$ and $\rho_{ens} (\Gamma)$
is the probability density function for the ensemble. This probability function is
a weight function for the averaging procedure and should be normalized,
\begin{equation}
    \sum_{\Gamma} \rho_{ens} (\Gamma) = 1 \, .
    \label{eq:normalized}
\end{equation}
With this information, it is now time to introduce the \emph{canonical ensemble}, which
is the main ensemble used throughout this work.

\subsection{Canonical ensemble}
The canonical ensemble is established as a system of $N$ particles in a fixed volume $V$
at temperature $T$ that can exchange energy with a heat bath. This ensemble has a
probability density function associated with it,
\begin{equation}
    \rho_{NVT} = \frac{e^{-\beta \mathcal{H}(\Gamma)}}{\sum_{\Gamma} e^{-\beta \mathcal{H}(\Gamma)}}
    \label{eq:canonical-density}
\end{equation}
where $\beta=1/k_{B} T$, with $k_{B}$ Boltzmann's constant. In the classical limit of
continuous distribution functions the denominator from \autoref{eq:canonical-density}
transform into
\begin{equation}
    Q(N,V,T) = \frac{1}{N! \, h^{3N}} \int d \vecp^{N} \, d \vecr^{N} \,
    e^{- \beta \mathcal{H} \left( \vecr^N, \vecp^N \right)}
    \label{eq:canonical-partition}
\end{equation}
which is known as the \emph{canonical partition function} or sum~\cite{huangStatisticalMechanics1987}.
Here, $h$ is an arbitrary but predetermined constant with the units of energy $\times$
time. As a side note, in the original formulation by Gibbs, the value of $h$ was set
to $h=1$~\cite{gibbsElementaryPrinciplesStatistical2014}, however, since the advent
of quantum mechanics, it is now taken to be Planck's constant~\cite{tolmanPrinciplesStatisticalMechanics1979}
in order to show a correspondence between the classical and quantum formulations.
Indeed, the integrals from \autoref{eq:canonical-partition} can be separated, and the
integral over the momentum coordinates can be carried out analitically giving,
\begin{equation}
    Q(N,V,T) = \frac{1}{N! \, \Lambda^{3N}} \int d \vecr^{N} \,
    e^{- \beta U \left( \vecr^N \right)}
    \label{eq:canonical-partition-position}
\end{equation}
with $\Lambda=\sqrt{h^2 / 2 \pi m k_{B} T}$ the thermal wavelength, also known as the
\emph{de Broglie} wavelength. This again shows a correspondence between classical
and quantum formulations. The remaining integral over the positions is called the
\emph{configuration integral},
\begin{equation}
    Z(N,V,T) = \int d \vecr^{N} \, e^{- \beta U \left( \vecr^N \right)} \, .
    \label{eq:configuration-int}
\end{equation}
Finally, we arrive at the canonical ensemble density function in the continuum limit
which is
\begin{equation}
    \rho_{NVT} = \frac{e^{- \beta U(\vecr^{N})}}{Z(N,V,T)} \, .
    \label{eq:canonical-limit}
\end{equation}
Using this probability density function, the ensemble average for an observable $A$ is
computed as
\begin{equation}
    \left< A \right> = \frac{\int e^{- \beta U(\vecr^{N})} \, A(\vecr^{N}) \, d \vecr^{N}}{Z(N,V,T)} \, .
    \label{eq:average-canonical}
\end{equation}